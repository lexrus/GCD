version: '2'

services:
  ghost:
    image: ghost
    volumes:
      - ./_content:/var/lib/ghost
    restart: "on-failure:3"
  caddy:
    image: abiosoft/caddy
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - ./Caddyfile:/etc/Caddyfile
    links:
      - ghost
    restart: "on-failure:3"
  dropbox:
    image: bennetimo/docker-dropbox
    restart: "on-failure:3"
  backup:
    image: bennetimo/ghost-backup
    volumes_from:
      - ghost
      - dropbox
    environment:
      BACKUP_LOCATION: "/root/Dropbox/"
      BACKUPS_RETAIN_LIMIT: 1
    restart: "on-failure:3"
